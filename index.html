<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<div class="vending-text-container">
		<p class="vending-text">This is paragraph 4.</p>
		<p class="vending-text">This is paragraph 3.</p>
		<p class="vending-text">This is paragraph 2.</p>
		<p class="vending-text active">This is paragraph 1.</p>
	</div>
	<button class="btn-slide slide-up">Slide up</button>
	<button class="btn-slide slide-down">Slide down</button>
	
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script>
	$(document).ready(function(){
		$.fn.extend({
		  reflow : function(){
		    var trigger = $("body").offset().top;
		    return this;
		  },
		  run: function(fn){
		  	fn();
		  	return this;
		  }
		});

		$(".btn-slide").click(function(){
			if($(".vending-text").data("play") == false) return;
			$(".vending-text").data("play", false);
			var $vendingList = $(".vending-text"),
				index = {}, $current, $next, state = {}, dir;
			dir = $(this).hasClass("slide-up") ? "up" : "down";
			
			index.current = $vendingList.index($vendingList.filter(".active"));
			if(dir == "up"){
				index.next = (index.current >= 1 ) ? (index.current - 1) : ($vendingList.length - 1);
			} else {
				index.next = (index.current + 1) % $vendingList.length;

			}
			
			state = {
				up : { current : "hide-top", next : "hide-bottom" },
				down : { current : "hide-bottom", next : "hide-top" }
			}

			$current = $vendingList.eq(index.current);
			$next = $vendingList.eq(index.next);
			
			$current.addClass("animate " + state[dir].current);
			$current.removeClass("active");
			$current.run(function(){
				setTimeout(function(){
					$current.addClass("hide");
					$(".vending-text").data("play", true);
				}, 400);
			});

			$next.removeClass("animate " + state[dir].current);
			$next.addClass(state[dir].next);
			$next.reflow();
			$next.addClass("active animate");
			$next.removeClass("hide " + state[dir].next);
		});
	});
	</script>
</body>
</html>